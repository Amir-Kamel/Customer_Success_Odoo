<odoo>
    <record id="view_customer_success_dashboard_kanban" model="ir.ui.view">
        <field name="name">customer.success.dashboard.contacts.kanban</field>
        <field name="model">customer.success.dashboard.contacts</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_customer_success_dashboard" create="false" edit="false" delete="false">
                <field name="partner_id"/>
                <field name="phone"/>
                <field name="email"/>
                <field name="average_health"/>
                <field name="record_count"/>
                <field name="partner_avatar_128" widget="image" options="{'no_download': True, 'clickable': False}"/>
                <templates>
                    <t t-name="kanban-box">
                        <div class="o_kanban_card o_partner_card"
                             style="width:280px; margin:8px; background:var(--o-view-background-color); padding:12px; border-radius:8px;
                                    box-shadow:0 1px 3px rgba(0,0,0,0.06);">
                            <div style="display:flex; align-items:center; gap:10px;">
                                <div class="o_kanban_image_fill position-relative"
                                     style="width:80px; height:80px; border-radius:50%; overflow:hidden;">
                                    <field name="partner_avatar_128" widget="image"
                                           options="{'img_class': 'object-fit-cover w-100 h-100',
                                                     'alt': 'Partner Image',
                                                     'no_download': True,
                                                     'clickable': False}"/>
                                </div>
                                <div style="flex:1;">
                                    <div style="font-weight:700; font-size:14px;">
                                        <t t-esc="record.partner_id.value ? record.partner_id.value : 'â€”'"/>
                                    </div>
                                    <!-- Optional extra info like phone/email here -->
                                    <div style="font-size:12px; color:#666;">
                                        <t t-if="record.phone.raw_value"><i class='fa fa-phone'/> <t t-esc="record.phone.raw_value"/></t>
                                        <t t-if="!record.phone.raw_value"><span style="color:#bbb;">No phone</span></t>
                                        <br/>
                                        <t t-if="record.email.raw_value"><i class='fa fa-envelope'/> <t t-esc="record.email.raw_value"/></t>
                                    </div>
                                </div>
                            </div>
                            <div style="margin-top:10px;">
                                <div style="display:flex; align-items:center; justify-content:space-between;">
                                    <button type="object" name="action_open_success_journeys" class="btn btn-sm btn-outline-primary">
                                        Open Journeys
                                    </button>
                                    <div style="font-weight:700;">
                                        <t t-esc="record.average_health.raw_value ? Math.round(record.average_health.raw_value*10)/10 : 0"/>%
                                    </div>
                                </div>
                                <!-- Compute percentage and assign Bootstrap colors -->
                                <t t-set="pct_int" t-value="record.average_health.raw_value || 0"/>
                                <t t-set="bar_class"
                                   t-value="pct_int &lt;= 25 ? 'bg-danger' : (pct_int &lt;= 50 ? 'bg-warning' : (pct_int &lt;= 75 ? 'bg-primary' : 'bg-success'))"/>
                                <!-- Progress bar with colors -->
                                <div class="progress mt-2" style="height:10px; border-radius:6px; overflow:hidden; margin-top:8px;">
                                    <div role="progressbar"
                                         t-att-class="'progress-bar ' + bar_class"
                                         t-att-style="'width: ' + pct_int + '%;'"
                                         t-att-aria-valuenow="pct_int" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <div style="margin-top:8px; display:flex; gap:8px; align-items:center;">
                                    <!-- Other content can go here, on the left -->
                                    <span style="font-size:12px; color:#777; margin-left:auto;">
                                        Records: <t t-esc="record.record_count.raw_value or 0"/>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

<record id="view_customer_success_dashboard_contacts_form" model="ir.ui.view">
    <field name="name">customer.success.dashboard.contacts.form</field>
    <field name="model">customer.success.dashboard.contacts</field>
    <field name="arch" type="xml">
        <form create="false" edit="false">
            <sheet>
                <field name="partner_avatar_128" widget="image" class="oe_avatar" readonly="1"/>
                <div class="oe_title">
                    <h1>
                        <field name="name" readonly="1"/>
                    </h1>
                </div>
                <group>
                    <group>
                        <field name="phone" readonly="1"/>
                        <field name="average_health" string="Average Journey" readonly="1"/>
                    </group>
                    <group>
                        <field name="email" readonly="1"/>
                        <field name="record_count" string="Journey Stories" readonly="1"/>
                    </group>
                </group>
                <separator string="Success Journeys"/>
                <field name="success_ids" readonly="1">
                    <list>
                        <field name="name" string="Title"/>
                        <field name="partner_id" string="Customer"/>
                         <field name="team_id"/>
                        <field name="stage_id"/>
                        <field name="assigned_user_id" string="Success Partner"/>
                    </list>
                </field>
                <div class="d-flex justify-content-end mx-3">
                <button type="object" name="action_open_success_journeys" class="btn btn-sm btn-outline-primary">
                    Open Journeys
                </button>
                </div>
            </sheet>
        </form>
    </field>
</record>


</odoo>
